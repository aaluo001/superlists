{% extends 'lists/base.html' %}

{% block header_text %}待办事项{% endblock %}

{% block form_action %}{% url 'view_list' list.id %}{% endblock %}

{% block dispaly_area_1 %}
    <table id="id_list_table" class="table table-condensed">
        {% for item in list.item_set.all %}
            <tr>
                <td width="40" >{{ forloop.counter }}</td>
                <td width="460" id="id_row_{{ forloop.counter }}">{{ item.text }}</td>
                <td width="40" align="right">
                    {# 第一条是清单标题，不能删除 #}
                    {% if user.email %}
                        <!-- <a href="{% url 'remove_list_item' item.id %}" class="btn btn-default btn-xs">×</a> -->
                        <form method="POST" action="{% url 'remove_list_item' item.id %}">
                            <button type="submit" class="btn btn-default btn-xs"
                                    {% if forloop.counter == 1 %} disabled {% endif %}>×</button>
                            {% csrf_token %}
                        </form>
                    {% endif %}
                </td>
                <td><br></td>
            </tr>
        {% endfor %}
    </table>

    {# 只有登录用户才能操作自己的清单 #}
    {% if user.email %}
        <form class="text-left" method="POST" action="{% url 'remove_list' list.id %}">
            <button class="btn btn-danger btn-sm">删除清单</button>
            {% csrf_token %}
        </form>
    {% endif %}
{% endblock %}
